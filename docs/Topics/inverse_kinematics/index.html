<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/miko-unity-docs/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/miko-unity-docs/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li:not(:nth-child(5)) > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(4) > ul > li:nth-child(5) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(4) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(4) > ul > li:nth-child(5) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(4) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(4) > ul.nav-list > li.nav-list-item:nth-child(5) > ul.nav-list { display: block; } </style> <script src="/miko-unity-docs/assets/js/vendor/lunr.min.js"></script> <script src="/miko-unity-docs/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Inverse Kinematics | MikoMiko Poser</title> <meta name="generator" content="Jekyll v4.4.1" /> <meta property="og:title" content="Inverse Kinematics" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Developer documentation site for the MikoMiko Unity Poser." /> <meta property="og:description" content="Developer documentation site for the MikoMiko Unity Poser." /> <link rel="canonical" href="https://therarefox.github.io/miko-unity-docs/docs/Topics/inverse_kinematics/" /> <meta property="og:url" content="https://therarefox.github.io/miko-unity-docs/docs/Topics/inverse_kinematics/" /> <meta property="og:site_name" content="MikoMiko Poser" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Inverse Kinematics" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Developer documentation site for the MikoMiko Unity Poser.","headline":"Inverse Kinematics","url":"https://therarefox.github.io/miko-unity-docs/docs/Topics/inverse_kinematics/"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/miko-unity-docs/" class="site-title lh-tight"> MikoMiko Poser </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/miko-unity-docs/" class="nav-list-link">Home</a></li><li class="nav-list-item"><a href="/miko-unity-docs/docs/overview/" class="nav-list-link">Project Overview</a></li><li class="nav-list-item"><a href="/miko-unity-docs/docs/deployment/" class="nav-list-link">Deployment Guide</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Topics category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/miko-unity-docs/docs/Topics/" class="nav-list-link">Topics</a><ul class="nav-list"><li class="nav-list-item"><a href="/miko-unity-docs/docs/Topics/camera_movement/" class="nav-list-link">Camera Movement</a></li><li class="nav-list-item"><a href="/miko-unity-docs/docs/Topics/scene_initalisation/" class="nav-list-link">Scene Initialization</a></li><li class="nav-list-item"><a href="/miko-unity-docs/docs/Topics/hand_editor/" class="nav-list-link">Hand Editor</a></li><li class="nav-list-item"><a href="/miko-unity-docs/docs/Topics/rendering_posekun/" class="nav-list-link">Rendering Posekun</a></li><li class="nav-list-item"><a href="/miko-unity-docs/docs/Topics/inverse_kinematics/" class="nav-list-link">Inverse Kinematics</a></li><li class="nav-list-item"><a href="/miko-unity-docs/docs/Topics/joint_structure/" class="nav-list-link">Joint Structure</a></li><li class="nav-list-item"><a href="/miko-unity-docs/docs/Topics/rotation_gizmo/" class="nav-list-link">Rotation Gizmo</a></li><li class="nav-list-item"><a href="/miko-unity-docs/docs/Topics/blinking_indicators/" class="nav-list-link">Blinking Indicators</a></li><li class="nav-list-item"><a href="/miko-unity-docs/docs/Topics/joint_restriction/" class="nav-list-link">Joint Restriction</a></li><li class="nav-list-item"><a href="/miko-unity-docs/docs/Topics/layers_and_tags/" class="nav-list-link">Layers and Tags</a></li><li class="nav-list-item"><a href="/miko-unity-docs/docs/Topics/posekun_modifications/" class="nav-list-link">Posekun Modifications</a></li><li class="nav-list-item"><a href="/miko-unity-docs/docs/Topics/loading_poses/" class="nav-list-link">Loading Poses</a></li></ul></li><li class="nav-list-item"><a href="/miko-unity-docs/docs/classes/" class="nav-list-link">Classes</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search MikoMiko Poser" aria-label="Search MikoMiko Poser" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://github.com/just-the-docs/just-the-docs-template" class="site-button" > Template Repository </a> </li> </ul> </nav> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/miko-unity-docs/docs/Topics/">Topics</a></li> <li class="breadcrumb-nav-list-item"><span>Inverse Kinematics</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <h1 class="no_toc" id="inverse-kinematics-ik"> <a href="#inverse-kinematics-ik" class="anchor-heading" aria-labelledby="inverse-kinematics-ik"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Inverse Kinematics (IK) </h1> <p class="fs-6 fw-300">Understanding the IK system that automatically positions joints to achieve natural poses.</p> <h2 class="no_toc text-delta" id="table-of-contents"> <a href="#table-of-contents" class="anchor-heading" aria-labelledby="table-of-contents"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Table of Contents </h2> <ol id="markdown-toc"> <li><a href="#overview" id="markdown-toc-overview">Overview</a></li> <li><a href="#disabling--enabling-ik" id="markdown-toc-disabling--enabling-ik">Disabling / Enabling IK</a></li> <li><a href="#ik-setup-in-addfbxcontroller" id="markdown-toc-ik-setup-in-addfbxcontroller">IK Setup (in AddFBXController)</a></li> <li><a href="#overall-flow" id="markdown-toc-overall-flow">Overall Flow</a></li> <li><a href="#related-classes" id="markdown-toc-related-classes">Related Classes</a></li> <li><a href="#ik-vs-forward-kinematics" id="markdown-toc-ik-vs-forward-kinematics">IK vs Forward Kinematics</a> <ol> <li><a href="#forward-kinematics-fk" id="markdown-toc-forward-kinematics-fk">Forward Kinematics (FK)</a></li> <li><a href="#inverse-kinematics-ik-1" id="markdown-toc-inverse-kinematics-ik-1">Inverse Kinematics (IK)</a></li> </ol> </li> <li><a href="#ik-chains-in-the-system" id="markdown-toc-ik-chains-in-the-system">IK Chains in the System</a> <ol> <li><a href="#arm-ik-chains" id="markdown-toc-arm-ik-chains">Arm IK Chains</a></li> <li><a href="#leg-ik-chains" id="markdown-toc-leg-ik-chains">Leg IK Chains</a></li> <li><a href="#spine-ik-chain" id="markdown-toc-spine-ik-chain">Spine IK Chain</a></li> </ol> </li> <li><a href="#ik-implementation" id="markdown-toc-ik-implementation">IK Implementation</a> <ol> <li><a href="#two-bone-ik-solver" id="markdown-toc-two-bone-ik-solver">Two-Bone IK Solver</a></li> <li><a href="#multi-bone-ik-solver" id="markdown-toc-multi-bone-ik-solver">Multi-Bone IK Solver</a></li> </ol> </li> <li><a href="#ik-solving-methods" id="markdown-toc-ik-solving-methods">IK Solving Methods</a> <ol> <li><a href="#fabrik-forward-and-backward-reaching-ik" id="markdown-toc-fabrik-forward-and-backward-reaching-ik">FABRIK (Forward And Backward Reaching IK)</a></li> <li><a href="#ccd-cyclic-coordinate-descent" id="markdown-toc-ccd-cyclic-coordinate-descent">CCD (Cyclic Coordinate Descent)</a></li> </ol> </li> <li><a href="#ik-constraints-and-hints" id="markdown-toc-ik-constraints-and-hints">IK Constraints and Hints</a> <ol> <li><a href="#pole-vectors" id="markdown-toc-pole-vectors">Pole Vectors</a></li> <li><a href="#joint-constraints" id="markdown-toc-joint-constraints">Joint Constraints</a></li> <li><a href="#weight-systems" id="markdown-toc-weight-systems">Weight Systems</a></li> </ol> </li> <li><a href="#ik-tools-and-interface" id="markdown-toc-ik-tools-and-interface">IK Tools and Interface</a> <ol> <li><a href="#ik-targets" id="markdown-toc-ik-targets">IK Targets</a></li> <li><a href="#ik-gizmos" id="markdown-toc-ik-gizmos">IK Gizmos</a></li> <li><a href="#ik-blending" id="markdown-toc-ik-blending">IK Blending</a></li> </ol> </li> <li><a href="#advanced-ik-features" id="markdown-toc-advanced-ik-features">Advanced IK Features</a> <ol> <li><a href="#multi-target-ik" id="markdown-toc-multi-target-ik">Multi-Target IK</a></li> <li><a href="#ik-retargeting" id="markdown-toc-ik-retargeting">IK Retargeting</a></li> <li><a href="#ik-animation" id="markdown-toc-ik-animation">IK Animation</a></li> </ol> </li> <li><a href="#performance-optimization" id="markdown-toc-performance-optimization">Performance Optimization</a> <ol> <li><a href="#update-frequency" id="markdown-toc-update-frequency">Update Frequency</a></li> <li><a href="#lod-level-of-detail" id="markdown-toc-lod-level-of-detail">LOD (Level of Detail)</a></li> <li><a href="#constraint-caching" id="markdown-toc-constraint-caching">Constraint Caching</a></li> </ol> </li> <li><a href="#troubleshooting" id="markdown-toc-troubleshooting">Troubleshooting</a> <ol> <li><a href="#ik-not-reaching-target" id="markdown-toc-ik-not-reaching-target">IK Not Reaching Target</a></li> <li><a href="#unnatural-ik-results" id="markdown-toc-unnatural-ik-results">Unnatural IK Results</a></li> <li><a href="#ik-performance-issues" id="markdown-toc-ik-performance-issues">IK Performance Issues</a></li> <li><a href="#ik-popping-or-jittering" id="markdown-toc-ik-popping-or-jittering">IK Popping or Jittering</a></li> </ol> </li> <li><a href="#ik-best-practices" id="markdown-toc-ik-best-practices">IK Best Practices</a> <ol> <li><a href="#pose-creation-workflow" id="markdown-toc-pose-creation-workflow">Pose Creation Workflow</a></li> <li><a href="#target-placement" id="markdown-toc-target-placement">Target Placement</a></li> </ol> </li> </ol><hr /> <h2 id="overview"> <a href="#overview" class="anchor-heading" aria-labelledby="overview"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Overview </h2> <p>IK is implemented for both arms and legs using Unity’s RigBuilder and Two Bone IK Constraint. Within the IK system, the target (item at the end of the limb) and hint objects (item that that elbow points towards) are required to ensure the system is fully working. However, the current IK setup simply sets the hint weights very low, so the hints don’t affect the IK much. “Currently, the settings used in the above sets the value of the Hint Weight to be low to ensure that when we use our rotation gizmo or make changes to posekun without the IK system, these changes are retained instead of being overridden. However, take note that the lower the hint weight, the lesser the arm or leg will bend towards the hint object, which may lead to less realistic limb movement.” - January 2025 Documentation YouTube video with the same IK setup: <a href="https://www.youtube.com/watch?v=TUBHvQ2XEJs">Inverse Kinematics Unity Tutorial in 3 minutes</a></p> <p class="text-center"><img src="../../assets/topics/IK1.png" alt="Image" /></p> <p class="text-center"><img src="../../assets/topics/IK2.png" alt="Image" /></p> <h2 id="disabling--enabling-ik"> <a href="#disabling--enabling-ik" class="anchor-heading" aria-labelledby="disabling--enabling-ik"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Disabling / Enabling IK </h2> <p>RigBuilder must be enabled for IK to function. However, it prevents FK (directly rotating the joint). Thus, RigBuilder component is disabled, and only enabled when the user is holding down the mouse on a movable IK target (the hands and feet joints).</p> <h2 id="ik-setup-in-addfbxcontroller"> <a href="#ik-setup-in-addfbxcontroller" class="anchor-heading" aria-labelledby="ik-setup-in-addfbxcontroller"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> IK Setup (in AddFBXController) </h2> <p>IK is setup at the start of the scene, by AddFBXController in the AddRig() and TwoBoneIKSetup() functions.</p> <p>Poser Documentation: AddFBXController</p> <p>More information on scene startup: Topic: Scene Initialization</p> <h2 id="overall-flow"> <a href="#overall-flow" class="anchor-heading" aria-labelledby="overall-flow"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Overall Flow </h2> <p class="text-center"><img src="../../assets/topics/IK3.png" alt="Image" /></p> <h2 id="related-classes"> <a href="#related-classes" class="anchor-heading" aria-labelledby="related-classes"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Related Classes </h2> <p>Poser Documentation: Drag Joint (IK) Poser Documentation: UpdateHintPositions &lt;!– Inverse Kinematics (IK) is a mathematical method that calculates joint positions to achieve a desired end-effector position. Instead of manually positioning each joint, IK allows you to move a hand or foot and automatically calculates the appropriate shoulder, elbow, hip, and knee positions.</p> <h2 id="ik-vs-forward-kinematics"> <a href="#ik-vs-forward-kinematics" class="anchor-heading" aria-labelledby="ik-vs-forward-kinematics"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> IK vs Forward Kinematics </h2> <h3 id="forward-kinematics-fk"> <a href="#forward-kinematics-fk" class="anchor-heading" aria-labelledby="forward-kinematics-fk"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Forward Kinematics (FK) </h3> <ul> <li><strong>Manual Control</strong>: Position each joint individually</li> <li><strong>Bottom-up</strong>: Start from root, work outward</li> <li><strong>Precise Control</strong>: Exact control over each joint angle</li> <li><strong>Time Intensive</strong>: Requires positioning multiple joints</li> </ul> <h3 id="inverse-kinematics-ik-1"> <a href="#inverse-kinematics-ik-1" class="anchor-heading" aria-labelledby="inverse-kinematics-ik-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Inverse Kinematics (IK) </h3> <ul> <li><strong>Goal-Oriented</strong>: Set target position, system calculates path</li> <li><strong>Top-down</strong>: Start from end goal, work inward</li> <li><strong>Natural Results</strong>: Automatically creates realistic poses</li> <li><strong>Efficient</strong>: Quick pose creation with fewer inputs</li> </ul> <h2 id="ik-chains-in-the-system"> <a href="#ik-chains-in-the-system" class="anchor-heading" aria-labelledby="ik-chains-in-the-system"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> IK Chains in the System </h2> <h3 id="arm-ik-chains"> <a href="#arm-ik-chains" class="anchor-heading" aria-labelledby="arm-ik-chains"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Arm IK Chains </h3> <p><strong>Left/Right Arm IK</strong>:</p> <ul> <li><strong>End Effector</strong>: Hand position</li> <li><strong>Chain</strong>: Shoulder → Elbow → Wrist → Hand</li> <li><strong>Target</strong>: User-defined hand position</li> <li><strong>Pole Vector</strong>: Elbow direction hint</li> </ul> <h3 id="leg-ik-chains"> <a href="#leg-ik-chains" class="anchor-heading" aria-labelledby="leg-ik-chains"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Leg IK Chains </h3> <p><strong>Left/Right Leg IK</strong>:</p> <ul> <li><strong>End Effector</strong>: Foot position</li> <li><strong>Chain</strong>: Hip → Knee → Ankle → Foot</li> <li><strong>Target</strong>: User-defined foot position</li> <li><strong>Pole Vector</strong>: Knee direction hint</li> </ul> <h3 id="spine-ik-chain"> <a href="#spine-ik-chain" class="anchor-heading" aria-labelledby="spine-ik-chain"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Spine IK Chain </h3> <p><strong>Spine IK</strong> (when enabled):</p> <ul> <li><strong>End Effector</strong>: Head or chest position</li> <li><strong>Chain</strong>: Hip → Spine → Chest → Neck → Head</li> <li><strong>Target</strong>: User-defined head position</li> </ul> <h2 id="ik-implementation"> <a href="#ik-implementation" class="anchor-heading" aria-labelledby="ik-implementation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> IK Implementation </h2> <h3 id="two-bone-ik-solver"> <a href="#two-bone-ik-solver" class="anchor-heading" aria-labelledby="two-bone-ik-solver"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Two-Bone IK Solver </h3> <p>Used for arms and legs (most common):</p> <div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">TwoBoneIK</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="n">Transform</span> <span class="n">upperJoint</span><span class="p">;</span>  <span class="c1">// Shoulder/Hip</span>
    <span class="k">public</span> <span class="n">Transform</span> <span class="n">middleJoint</span><span class="p">;</span> <span class="c1">// Elbow/Knee  </span>
    <span class="k">public</span> <span class="n">Transform</span> <span class="n">endJoint</span><span class="p">;</span>    <span class="c1">// Wrist/Ankle</span>
    <span class="k">public</span> <span class="n">Transform</span> <span class="n">target</span><span class="p">;</span>      <span class="c1">// Goal position</span>
    <span class="k">public</span> <span class="n">Transform</span> <span class="n">poleVector</span><span class="p">;</span>  <span class="c1">// Direction hint</span>
    
    <span class="k">public</span> <span class="k">void</span> <span class="nf">Solve</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// Calculate joint positions to reach target</span>
        <span class="c1">// while maintaining bone length constraints</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <h3 id="multi-bone-ik-solver"> <a href="#multi-bone-ik-solver" class="anchor-heading" aria-labelledby="multi-bone-ik-solver"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Multi-Bone IK Solver </h3> <p>Used for spine and complex chains:</p> <div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">MultiBoneIK</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="n">Transform</span><span class="p">[]</span> <span class="n">jointChain</span><span class="p">;</span> <span class="c1">// All joints in chain</span>
    <span class="k">public</span> <span class="n">Transform</span> <span class="n">target</span><span class="p">;</span>       <span class="c1">// End goal</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="n">iterations</span> <span class="p">=</span> <span class="m">10</span><span class="p">;</span>    <span class="c1">// Solving precision</span>
    
    <span class="k">public</span> <span class="k">void</span> <span class="nf">Solve</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// Iteratively adjust joints to reach target</span>
        <span class="c1">// using FABRIK or CCD algorithm</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <h2 id="ik-solving-methods"> <a href="#ik-solving-methods" class="anchor-heading" aria-labelledby="ik-solving-methods"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> IK Solving Methods </h2> <h3 id="fabrik-forward-and-backward-reaching-ik"> <a href="#fabrik-forward-and-backward-reaching-ik" class="anchor-heading" aria-labelledby="fabrik-forward-and-backward-reaching-ik"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> FABRIK (Forward And Backward Reaching IK) </h3> <p><strong>Advantages</strong>:</p> <ul> <li>Fast convergence</li> <li>Stable results</li> <li>Natural joint positioning</li> </ul> <p><strong>Process</strong>:</p> <ol> <li><strong>Forward Pass</strong>: Work from end to root</li> <li><strong>Backward Pass</strong>: Work from root to end</li> <li><strong>Iterate</strong>: Repeat until target reached</li> </ol> <h3 id="ccd-cyclic-coordinate-descent"> <a href="#ccd-cyclic-coordinate-descent" class="anchor-heading" aria-labelledby="ccd-cyclic-coordinate-descent"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> CCD (Cyclic Coordinate Descent) </h3> <p><strong>Advantages</strong>:</p> <ul> <li>Simple implementation</li> <li>Works with any number of joints</li> <li>Predictable results</li> </ul> <p><strong>Process</strong>:</p> <ol> <li><strong>Start from end joint</strong></li> <li><strong>Rotate each joint</strong> toward target</li> <li><strong>Move up chain</strong> sequentially</li> <li><strong>Repeat</strong> until convergence</li> </ol> <h2 id="ik-constraints-and-hints"> <a href="#ik-constraints-and-hints" class="anchor-heading" aria-labelledby="ik-constraints-and-hints"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> IK Constraints and Hints </h2> <h3 id="pole-vectors"> <a href="#pole-vectors" class="anchor-heading" aria-labelledby="pole-vectors"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Pole Vectors </h3> <p>Guide the middle joint direction:</p> <div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Example: Elbow pole vector</span>
<span class="n">Vector3</span> <span class="n">elbowDirection</span> <span class="p">=</span> <span class="n">poleVector</span><span class="p">.</span><span class="n">position</span> <span class="p">-</span> <span class="n">shoulder</span><span class="p">.</span><span class="n">position</span><span class="p">;</span>
<span class="c1">// IK solver uses this to determine elbow placement</span>
</code></pre></div></div> <h3 id="joint-constraints"> <a href="#joint-constraints" class="anchor-heading" aria-labelledby="joint-constraints"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Joint Constraints </h3> <p>Maintain anatomical realism:</p> <ul> <li><strong>Rotation Limits</strong>: Prevent unnatural bending</li> <li><strong>Twist Limits</strong>: Control bone rotation</li> <li><strong>Plane Constraints</strong>: Keep joints on anatomical planes</li> </ul> <h3 id="weight-systems"> <a href="#weight-systems" class="anchor-heading" aria-labelledby="weight-systems"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Weight Systems </h3> <p>Control IK influence:</p> <div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">IKWeight</span>
<span class="p">{</span>
    <span class="p">[</span><span class="nf">Range</span><span class="p">(</span><span class="m">0f</span><span class="p">,</span> <span class="m">1f</span><span class="p">)]</span>
    <span class="k">public</span> <span class="kt">float</span> <span class="n">positionWeight</span> <span class="p">=</span> <span class="m">1f</span><span class="p">;</span> <span class="c1">// Target position influence</span>
    
    <span class="p">[</span><span class="nf">Range</span><span class="p">(</span><span class="m">0f</span><span class="p">,</span> <span class="m">1f</span><span class="p">)]</span> 
    <span class="k">public</span> <span class="kt">float</span> <span class="n">rotationWeight</span> <span class="p">=</span> <span class="m">1f</span><span class="p">;</span> <span class="c1">// Target rotation influence</span>
<span class="p">}</span>
</code></pre></div></div> <h2 id="ik-tools-and-interface"> <a href="#ik-tools-and-interface" class="anchor-heading" aria-labelledby="ik-tools-and-interface"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> IK Tools and Interface </h2> <h3 id="ik-targets"> <a href="#ik-targets" class="anchor-heading" aria-labelledby="ik-targets"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> IK Targets </h3> <p>Visual targets for IK positioning:</p> <ul> <li><strong>Hand Targets</strong>: Spherical gizmos for hand positioning</li> <li><strong>Foot Targets</strong>: Ground-aligned targets for foot placement</li> <li><strong>Look Targets</strong>: Eye/head direction targets</li> </ul> <h3 id="ik-gizmos"> <a href="#ik-gizmos" class="anchor-heading" aria-labelledby="ik-gizmos"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> IK Gizmos </h3> <p>Visual manipulation tools:</p> <ul> <li><strong>Position Handles</strong>: Move IK targets in 3D space</li> <li><strong>Rotation Handles</strong>: Orient end effectors</li> <li><strong>Pole Vector Handles</strong>: Adjust joint direction hints</li> </ul> <h3 id="ik-blending"> <a href="#ik-blending" class="anchor-heading" aria-labelledby="ik-blending"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> IK Blending </h3> <p>Smooth transitions between IK and FK:</p> <div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Blend between IK and FK based on weight</span>
<span class="n">finalPosition</span> <span class="p">=</span> <span class="n">Vector3</span><span class="p">.</span><span class="nf">Lerp</span><span class="p">(</span><span class="n">fkPosition</span><span class="p">,</span> <span class="n">ikPosition</span><span class="p">,</span> <span class="n">ikWeight</span><span class="p">);</span>
<span class="n">finalRotation</span> <span class="p">=</span> <span class="n">Quaternion</span><span class="p">.</span><span class="nf">Lerp</span><span class="p">(</span><span class="n">fkRotation</span><span class="p">,</span> <span class="n">ikRotation</span><span class="p">,</span> <span class="n">ikWeight</span><span class="p">);</span>
</code></pre></div></div> <h2 id="advanced-ik-features"> <a href="#advanced-ik-features" class="anchor-heading" aria-labelledby="advanced-ik-features"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Advanced IK Features </h2> <h3 id="multi-target-ik"> <a href="#multi-target-ik" class="anchor-heading" aria-labelledby="multi-target-ik"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Multi-Target IK </h3> <p>Handle multiple constraints simultaneously:</p> <ul> <li><strong>Dual hand targets</strong>: Both hands reaching different positions</li> <li><strong>Ground constraints</strong>: Feet maintaining contact with surface</li> <li><strong>Look-at targets</strong>: Head following specific objects</li> </ul> <h3 id="ik-retargeting"> <a href="#ik-retargeting" class="anchor-heading" aria-labelledby="ik-retargeting"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> IK Retargeting </h3> <p>Apply poses between different characters:</p> <div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Scale IK targets based on character proportions</span>
<span class="n">Vector3</span> <span class="n">scaledTarget</span> <span class="p">=</span> <span class="n">originalTarget</span> <span class="p">*</span> <span class="p">(</span><span class="n">targetCharacterHeight</span> <span class="p">/</span> <span class="n">sourceCharacterHeight</span><span class="p">);</span>
</code></pre></div></div> <h3 id="ik-animation"> <a href="#ik-animation" class="anchor-heading" aria-labelledby="ik-animation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> IK Animation </h3> <p>Record and play back IK-based animations:</p> <ul> <li><strong>Keyframe IK targets</strong> instead of individual joints</li> <li><strong>Interpolate target positions</strong> between keyframes</li> <li><strong>Maintain IK solving</strong> during animation playback</li> </ul> <h2 id="performance-optimization"> <a href="#performance-optimization" class="anchor-heading" aria-labelledby="performance-optimization"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Performance Optimization </h2> <h3 id="update-frequency"> <a href="#update-frequency" class="anchor-heading" aria-labelledby="update-frequency"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Update Frequency </h3> <p>Control when IK solving occurs:</p> <ul> <li><strong>Every Frame</strong>: Smooth real-time updates</li> <li><strong>Fixed Update</strong>: Consistent physics-based updates</li> <li><strong>On Demand</strong>: Only when targets change</li> </ul> <h3 id="lod-level-of-detail"> <a href="#lod-level-of-detail" class="anchor-heading" aria-labelledby="lod-level-of-detail"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> LOD (Level of Detail) </h3> <p>Reduce IK complexity based on distance:</p> <div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="p">(</span><span class="n">distanceToCamera</span> <span class="p">&gt;</span> <span class="n">lodDistance</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// Use simpler IK solving or disable entirely</span>
    <span class="n">ikSolver</span><span class="p">.</span><span class="n">iterations</span> <span class="p">=</span> <span class="m">2</span><span class="p">;</span> <span class="c1">// Reduce precision</span>
<span class="p">}</span>
</code></pre></div></div> <h3 id="constraint-caching"> <a href="#constraint-caching" class="anchor-heading" aria-labelledby="constraint-caching"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Constraint Caching </h3> <p>Pre-calculate constraint boundaries:</p> <ul> <li><strong>Cache joint limits</strong> to avoid repeated calculations</li> <li><strong>Pre-compute</strong> common IK solutions</li> <li><strong>Batch</strong> multiple IK solvers when possible</li> </ul> <h2 id="troubleshooting"> <a href="#troubleshooting" class="anchor-heading" aria-labelledby="troubleshooting"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Troubleshooting </h2> <h3 id="ik-not-reaching-target"> <a href="#ik-not-reaching-target" class="anchor-heading" aria-labelledby="ik-not-reaching-target"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> IK Not Reaching Target </h3> <ul> <li><strong>Check</strong>: Target is within reach of joint chain</li> <li><strong>Verify</strong>: Bone lengths are correctly set</li> <li><strong>Increase</strong>: IK solver iteration count</li> <li><strong>Debug</strong>: Visualize joint chain and constraints</li> </ul> <h3 id="unnatural-ik-results"> <a href="#unnatural-ik-results" class="anchor-heading" aria-labelledby="unnatural-ik-results"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Unnatural IK Results </h3> <ul> <li><strong>Enable</strong>: Joint rotation constraints</li> <li><strong>Adjust</strong>: Pole vector positions</li> <li><strong>Tune</strong>: IK weights and blending</li> <li><strong>Check</strong>: Bone orientations match anatomical axes</li> </ul> <h3 id="ik-performance-issues"> <a href="#ik-performance-issues" class="anchor-heading" aria-labelledby="ik-performance-issues"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> IK Performance Issues </h3> <ul> <li><strong>Reduce</strong>: Solver iteration count</li> <li><strong>Implement</strong>: LOD system for distant characters</li> <li><strong>Optimize</strong>: Update frequency based on movement</li> <li><strong>Cache</strong>: Repeated IK calculations</li> </ul> <h3 id="ik-popping-or-jittering"> <a href="#ik-popping-or-jittering" class="anchor-heading" aria-labelledby="ik-popping-or-jittering"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> IK Popping or Jittering </h3> <ul> <li><strong>Smooth</strong>: Target movement with interpolation</li> <li><strong>Add</strong>: Damping to IK solver</li> <li><strong>Check</strong>: Target positions aren’t jumping</li> <li><strong>Ensure</strong>: Consistent solver settings</li> </ul> <h2 id="ik-best-practices"> <a href="#ik-best-practices" class="anchor-heading" aria-labelledby="ik-best-practices"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> IK Best Practices </h2> <h3 id="pose-creation-workflow"> <a href="#pose-creation-workflow" class="anchor-heading" aria-labelledby="pose-creation-workflow"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Pose Creation Workflow </h3> <ol> <li><strong>Start with IK</strong> for major positioning (hands, feet)</li> <li><strong>Use FK</strong> for fine-tuning individual joints</li> <li><strong>Blend IK/FK</strong> for natural transitions</li> <li><strong>Test constraints</strong> to ensure realism</li> </ol> <h3 id="target-placement"> <a href="#target-placement" class="anchor-heading" aria-labelledby="target-placement"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Target Placement </h3> <ul> <li><strong>Place targets</strong> slightly before final position</li> <li><strong>Use smooth curves</strong> for target movement</li> <li><strong>Maintain targets</strong> within anatomical reach</li> <li><strong>Consider character proportions</strong> when positioning</li> </ul><hr /> <p><em>For more information about joint constraints, see <a href="joint_restriction.html">Joint Restriction</a>. For joint hierarchy details, see <a href="joint_structure.html">Joint Structure</a>.</em> –&gt;</p> </main> <hr> <footer> <p><a href="#top" id="back-to-top">Back to top</a></p> <div class="d-flex mt-2"> <p class="text-small text-grey-dk-000 mb-0"> <a href="https://github.com/just-the-docs/just-the-docs/tree/main/docs/Topics/inverse_kinematics.md" id="edit-this-page">Edit this page on GitHub</a> </p> </div> </footer> </div> </div> <div class="search-overlay"></div> </div> <script src="https://cdn.jsdelivr.net/npm/mermaid@9.1.6/dist/mermaid.min.js"></script> <script> var config = {} ; mermaid.initialize(config); window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid')); </script> </body> </html>
